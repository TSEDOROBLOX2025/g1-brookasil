<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>g1 - Brookasil Oficial</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --g1-red: #C4170C;
            --g1-dark-red: #a3130a;
            --bg-gray: #f6f6f6;
            --text-black: #111;
            --text-gray: #666;
            --border: #ddd;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Open Sans', sans-serif; }
        body { background-color: var(--bg-gray); color: var(--text-black); overflow-x: hidden; }

        /* HEADER & NAV */
        header { background: var(--g1-red); color: white; height: 65px; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; position: sticky; top: 0; z-index: 1000; }
        .logo { font-weight: 900; font-size: 32px; letter-spacing: -2px; cursor: pointer; }
        .logo span { font-weight: 400; font-size: 18px; letter-spacing: 0; margin-left: 5px; opacity: 0.9; }
        
        .user-pill { background: rgba(0,0,0,0.2); padding: 6px 15px; border-radius: 20px; font-size: 13px; cursor: pointer; display: flex; align-items: center; gap: 8px; }
        .user-pill img { width: 24px; height: 24px; border-radius: 50%; object-fit: cover; background: #fff; }

        /* MENU LATERAL */
        #side-menu { position: fixed; top: 0; left: -300px; width: 300px; height: 100%; background: white; box-shadow: 5px 0 15px rgba(0,0,0,0.1); z-index: 2000; transition: 0.3s; padding: 20px; }
        #side-menu.active { left: 0; }
        .menu-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; z-index: 1999; }
        .menu-item { padding: 15px; border-bottom: 1px solid #eee; color: var(--g1-red); font-weight: bold; cursor: pointer; text-transform: uppercase; font-size: 13px; }

        /* BARRA INFO */
        .info-bar { background: white; border-bottom: 1px solid var(--border); padding: 8px 20px; display: flex; justify-content: center; gap: 20px; font-size: 12px; font-weight: bold; color: var(--text-gray); }

        /* GRID */
        .container { max-width: 1100px; margin: 20px auto; padding: 0 15px; min-height: 80vh; }
        .section { display: none; animation: fadeIn 0.3s ease; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .news-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 30px; }
        .card { background: white; border-bottom: 1px solid var(--border); cursor: pointer; }
        .card img { width: 100%; height: 200px; object-fit: cover; }
        .card-body { padding: 15px 0; }
        .card-cat { color: var(--g1-red); font-size: 11px; font-weight: 800; text-transform: uppercase; }
        .card-title { font-size: 22px; font-weight: 800; line-height: 1.1; margin: 10px 0; }

        /* FORMUL√ÅRIOS */
        .box { background: white; padding: 25px; border: 1px solid var(--border); margin-bottom: 20px; border-radius: 4px; }
        input, textarea, select { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; font-size: 15px; }
        .btn { background: var(--g1-red); color: white; border: none; padding: 12px; border-radius: 4px; font-weight: bold; cursor: pointer; width: 100%; text-transform: uppercase; }
        .btn:hover { background: var(--g1-dark-red); }

        /* MODAL NOTICIA */
        #modal-noticia { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 3000; display: none; overflow-y: auto; padding: 40px 20px; }
        .modal-body { max-width: 800px; margin: 0 auto; }
        .modal-img { width: 100%; border-radius: 4px; margin: 20px 0; }

        #toast { display: none; position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #333; color: white; padding: 12px 25px; border-radius: 30px; z-index: 6000; }
    </style>
</head>
<body>

    <div id="toast">Sucesso!</div>
    <div class="menu-overlay" id="overlay" onclick="toggleMenu()"></div>

    <div id="side-menu">
        <h2 style="color:var(--g1-red); margin-bottom:20px;">Menu</h2>
        <div class="menu-item" onclick="showSec('home')">Home</div>
        <div class="menu-item" onclick="showSec('admin')">Painel Admin</div>
        <div class="menu-item" onclick="window.open('https://tsedoroblox2025.github.io/candidatura-cde/')">Candidatura CDE</div>
        <div class="menu-item" onclick="window.open('https://tsedoroblox2025.github.io/filia-o.html/')">Filia√ß√£o Partid√°ria</div>
    </div>

    <header>
        <div style="display:flex; align-items:center; gap:15px;">
            <div style="font-size:25px; cursor:pointer;" onclick="toggleMenu()">‚ò∞</div>
            <div class="logo" onclick="location.reload()">g1<span>Brookasil</span></div>
        </div>
        <div class="user-pill" onclick="showSec('conta')">
            <img id="nav-foto" src="https://via.placeholder.com/30">
            <span id="nav-nome">Minha Conta</span>
        </div>
    </header>

    <div class="info-bar">
        <span style="color:red">‚óè AO VIVO</span>
        <span id="clima-txt">üå§Ô∏è CARREGANDO...</span>
        <span id="relogio">00:00:00</span>
    </div>

    <div class="container">
        
        <section id="sec-home" class="section active">
            <div id="feed" class="news-grid">
                <p style="text-align:center; grid-column: 1/-1;">Carregando not√≠cias em tempo real...</p>
            </div>
        </section>

        <section id="sec-conta" class="section">
            <div class="box">
                <h2>üë§ Perfil do Cidad√£o</h2>
                <input type="text" id="user-nome" placeholder="Nome no RP">
                <textarea id="user-bio" placeholder="Biografia"></textarea>
                <label>Foto de Perfil:</label>
                <input type="file" id="user-file" accept="image/*" onchange="encodeImg(this, 'prev-user')">
                <center><img id="prev-user" style="width:100px; height:100px; border-radius:50%; object-fit:cover; display:none; margin:10px;"></center>
                <button class="btn" onclick="saveUser()">Salvar Perfil</button>
            </div>
        </section>

        <section id="sec-admin" class="section">
            <div class="box">
                <h2>üîê Painel de Controle</h2>
                <div id="auth-area">
                    <input type="password" id="pass" placeholder="Senha Administrativa">
                    <button class="btn" onclick="login()">Entrar</button>
                </div>

                <div id="admin-area" style="display:none;">
                    <div id="dono-area" style="display:none; background:#fff5f5; padding:15px; margin-bottom:20px;">
                        <h4>üëë Controles de Dono</h4>
                        <input type="text" id="in-clima" placeholder="Ex: ‚õàÔ∏è TEMPESTADE: 18¬∞C">
                        <button class="btn" style="background:#333" onclick="updateClima()">Atualizar Clima</button>
                        <hr style="margin:15px 0;">
                        <input type="text" id="in-autor" placeholder="Novo nome de Autor">
                        <button class="btn" style="background:#333" onclick="addAutor()">Cadastrar Autor</button>
                    </div>

                    <h3>‚úçÔ∏è Nova Reportagem</h3>
                    <input type="text" id="n-tit" placeholder="T√≠tulo">
                    <input type="text" id="n-sub" placeholder="Subt√≠tulo">
                    <label>Selecione o Autor:</label>
                    <select id="n-aut">
                        </select>
                    <select id="n-cat">
                        <option>Pol√≠tica</option><option>Policial</option><option>Cidades</option><option>Sa√∫de</option>
                    </select>
                    <textarea id="n-txt" rows="8" placeholder="Texto da not√≠cia..."></textarea>
                    <input type="file" accept="image/*" onchange="encodeImg(this, 'prev-n')">
                    <img id="prev-n" style="width:100%; display:none; margin-bottom:15px;">
                    <button class="btn" onclick="publish()">Publicar no g1</button>
                </div>
            </div>
        </section>

    </div>

    <div id="modal-noticia">
        <div class="modal-body">
            <button class="btn" style="width:auto; background:#666" onclick="closeModal()">‚Üê Voltar</button>
            <div id="modal-content"></div>
            <hr style="margin:20px 0;">
            <h3>üí¨ Coment√°rios</h3>
            <div id="comments"></div>
            <div style="margin-top:20px;">
                <input type="text" id="c-txt" placeholder="Escreva um coment√°rio...">
                <button class="btn" style="width:100px" onclick="postComment()">Enviar</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        // CONFIGURA√á√ÉO FIREBASE
        const firebaseConfig = { databaseURL: "https://g1-brookasil-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let currentImg = "";
        let activePost = "";

        // FUN√á√ïES DE IMAGEM
        function encodeImg(input, target) {
            const reader = new FileReader();
            reader.onload = e => {
                currentImg = e.target.result;
                document.getElementById(target).src = e.target.result;
                document.getElementById(target).style.display = 'block';
            };
            reader.readAsDataURL(input.files[0]);
        }

        // NAVEGA√á√ÉO
        function toggleMenu() {
            document.getElementById('side-menu').classList.toggle('active');
            document.getElementById('overlay').style.display = document.getElementById('overlay').style.display === 'block' ? 'none' : 'block';
        }

        function showSec(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('sec-' + id).classList.add('active');
            if(id !== 'admin') toggleMenu();
        }

        // PERFIL
        function saveUser() {
            const user = { nome: document.getElementById('user-nome').value, bio: document.getElementById('user-bio').value, foto: currentImg };
            localStorage.setItem('g1_user', JSON.stringify(user));
            toast("Perfil Salvo!");
            setTimeout(() => location.reload(), 1000);
        }

        // ADMIN
        function login() {
            const p = document.getElementById('pass').value;
            if(p === "Brookasil1234" || p === "G1_Brookasil") {
                document.getElementById('auth-area').style.display = 'none';
                document.getElementById('admin-area').style.display = 'block';
                if(p === "Brookasil1234") document.getElementById('dono-area').style.display = 'block';
            } else alert("Senha incorreta!");
        }

        function updateClima() {
            db.ref('clima').set(document.getElementById('in-clima').value);
            toast("Clima atualizado!");
        }

        function addAutor() {
            const nome = document.getElementById('in-autor').value;
            if(nome) db.ref('autores').push(nome).then(() => {
                document.getElementById('in-autor').value = "";
                toast("Autor adicionado!");
            });
        }

        function publish() {
            const data = {
                titulo: document.getElementById('n-tit').value,
                sub: document.getElementById('n-sub').value,
                autor: document.getElementById('n-aut').value,
                cat: document.getElementById('n-cat').value,
                texto: document.getElementById('n-txt').value,
                foto: currentImg,
                data: new Date().toLocaleString(),
                ts: Date.now()
            };
            db.ref('posts').push(data).then(() => {
                toast("Publicado!");
                location.reload();
            });
        }

        // CARREGAMENTO REALTIME
        function init() {
            // Clima
            db.ref('clima').on('value', s => { document.getElementById('clima-txt').innerText = s.val() || "üå§Ô∏è ENSOLARADO: 25¬∞C"; });

            // Autores (Lista Din√¢mica)
            db.ref('autores').on('value', s => {
                const sel = document.getElementById('n-aut');
                sel.innerHTML = "";
                // Autores Padr√£o
                const padrao = ["Charles Roitman", "Tutu Prot√°sio", "Anderson Roitman", "Drinho Oliver", "Arthur Monteiro", "Pop√≥ Cardoso", "Davi Zavarisi"];
                padrao.forEach(a => sel.innerHTML += `<option>${a}</option>`);
                // Autores do Banco
                s.forEach(c => { sel.innerHTML += `<option>${c.val()}</option>`; });
            });

            // Feed de Not√≠cias
            db.ref('posts').orderByChild('ts').on('value', snap => {
                const feed = document.getElementById('feed');
                feed.innerHTML = "";
                let posts = [];
                snap.forEach(c => { posts.push({id: c.key, ...c.val()}); });
                posts.reverse().forEach(p => {
                    feed.innerHTML += `
                        <div class="card" onclick="openPost('${p.id}')">
                            <img src="${p.foto}">
                            <div class="card-body">
                                <span class="card-cat">${p.cat}</span>
                                <h2 class="card-title">${p.titulo}</h2>
                                <p style="color:#666; font-size:14px;">${p.sub}</p>
                            </div>
                        </div>`;
                });
            });

            // Rel√≥gio
            setInterval(() => { document.getElementById('relogio').innerText = new Date().toLocaleTimeString(); }, 1000);

            // Carregar User Local
            const u = JSON.parse(localStorage.getItem('g1_user'));
            if(u) {
                document.getElementById('nav-nome').innerText = u.nome;
                if(u.foto) document.getElementById('nav-foto').src = u.foto;
            }
        }

        function openPost(id) {
            activePost = id;
            db.ref('posts/'+id).once('value', s => {
                const p = s.val();
                document.getElementById('modal-content').innerHTML = `
                    <span class="card-cat">${p.cat}</span>
                    <h1 style="font-size:35px; margin:15px 0;">${p.titulo}</h1>
                    <p style="font-size:20px; color:#555;">${p.sub}</p>
                    <hr style="margin:15px 0;">
                    <small>Por <b>${p.autor}</b> ‚Äî ${p.data}</small>
                    <img src="${p.foto}" class="modal-img">
                    <div style="font-size:18px; line-height:1.8;">${p.texto.replace(/\n/g, '<br><br>')}</div>
                `;
                document.getElementById('modal-noticia').style.display = 'block';
                loadComments(id);
            });
        }

        function closeModal() { document.getElementById('modal-noticia').style.display = 'none'; }

        function postComment() {
            const u = JSON.parse(localStorage.getItem('g1_user'));
            if(!u) return alert("Crie uma conta para comentar!");
            const txt = document.getElementById('c-txt').value;
            if(txt) db.ref('comments/'+activePost).push({ nome: u.nome, txt, foto: u.foto }).then(() => {
                document.getElementById('c-txt').value = "";
            });
        }

        function loadComments(id) {
            db.ref('comments/'+id).on('value', s => {
                const box = document.getElementById('comments');
                box.innerHTML = "";
                s.forEach(c => {
                    const d = c.val();
                    box.innerHTML += `<div style="margin-bottom:10px;"><b>${d.nome}:</b> ${d.txt}</div>`;
                });
            });
        }

        function toast(m) {
            const t = document.getElementById('toast');
            t.innerText = m; t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 3000);
        }

        init();
    </script>
</body>
</html>
