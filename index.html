<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>g1 - Brookasil Oficial</title>
    <style>
        :root { 
            --g1-red: #C4170C; 
            --g1-bg: #f6f6f6; 
            --g1-dark: #1e1e1e; 
            --xmas-green: #0a5c2f;
            --xmas-gold: #f1c40f;
            --text-main: #333333;
            --text-sub: #666666;
        }
        
        body { font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; margin: 0; background-color: var(--g1-bg); color: var(--text-main); line-height: 1.6; }
        
        /* EFEITO NEVE */
        #snow { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; }

        /* HEADER */
        header { background-color: var(--g1-red); color: white; padding: 0 20px; display: flex; align-items: center; position: sticky; top: 0; z-index: 2000; height: 65px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); justify-content: space-between; }
        .header-left { display: flex; align-items: center; }
        .menu-icon { font-size: 28px; cursor: pointer; margin-right: 15px; transition: 0.2s; }
        .logo { font-weight: 900; font-size: 38px; letter-spacing: -3px; cursor: pointer; text-decoration: none; color: white; display: flex; align-items: center; }
        .logo span { font-size: 20px; letter-spacing: 0; margin-left: 8px; font-weight: 400; opacity: 0.9; }
        
        /* PERFIL USU√ÅRIO */
        .user-section { display: flex; align-items: center; background: rgba(0,0,0,0.15); padding: 5px 15px; border-radius: 30px; cursor: pointer; transition: 0.3s; }
        .user-section:hover { background: rgba(0,0,0,0.25); }
        .user-section span { font-size: 14px; font-weight: bold; margin-left: 8px; }

        /* BARRA DE CLIMA */
        .weather-strip { background: white; border-bottom: 1px solid #ddd; padding: 8px 20px; display: flex; justify-content: center; gap: 20px; font-size: 13px; font-weight: bold; }
        .weather-strip .live { color: var(--g1-red); animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }

        /* CATEGORIAS */
        .sub-header { background: white; border-bottom: 1px solid #e0e0e0; padding: 10px 0; display: flex; justify-content: center; gap: 20px; position: sticky; top: 65px; z-index: 1000; overflow-x: auto; }
        .sub-header a { color: var(--g1-red); text-decoration: none; text-transform: uppercase; font-size: 12px; font-weight: 800; padding: 5px 10px; cursor: pointer; }

        /* MENU LATERAL */
        nav { height: 100%; width: 0; position: fixed; z-index: 3000; top: 0; left: 0; background-color: white; transition: 0.4s; padding-top: 60px; box-shadow: 10px 0 30px rgba(0,0,0,0.2); overflow-x: hidden; }
        nav a { padding: 18px 30px; text-decoration: none; font-size: 16px; color: #333; display: block; font-weight: 600; border-bottom: 1px solid #f5f5f5; cursor: pointer; }
        nav .closebtn { position: absolute; top: 10px; right: 20px; font-size: 40px; cursor: pointer; color: var(--g1-red); }

        /* CONTAINER PRINCIPAL */
        .container { max-width: 1100px; margin: 30px auto; padding: 0 20px; min-height: 100vh; }
        .section { display: none; }
        .section.active { display: block; }

        /* CLASSIFICADOS */
        .ads-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .ad-card { background: white; padding: 20px; border-radius: 8px; border-top: 4px solid var(--xmas-green); box-shadow: 0 2px 10px rgba(0,0,0,0.05); }

        /* COMENT√ÅRIOS */
        .comments-section { margin-top: 40px; border-top: 2px solid #eee; padding-top: 20px; }
        .comment-item { background: #f9f9f9; padding: 15px; border-radius: 8px; margin-bottom: 10px; font-size: 14px; }
        .comment-item b { color: var(--g1-red); }

        /* CARDS NOT√çCIAS */
        .news-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 25px; }
        .card { background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); cursor: pointer; }
        .card-img { width: 100%; height: 210px; object-fit: cover; }
        .card-content { padding: 20px; }
        .titulo { font-size: 22px; font-weight: 800; line-height: 1.2; margin-bottom: 10px; color: #000; }

        input, textarea, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; margin-bottom: 10px; box-sizing: border-box; }
        .btn-post { background: var(--g1-red); color: white; border: none; padding: 15px; border-radius: 6px; font-weight: 800; cursor: pointer; width: 100%; }

        #news-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 4000; overflow-y: auto; }
        #toast { display: none; position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: #2ecc71; color: white; padding: 15px 35px; border-radius: 8px; z-index: 10000; font-weight: bold; }
    </style>
</head>
<body>

    <canvas id="snow"></canvas>
    <div id="toast">Sucesso!</div>

    <header>
        <div class="header-left">
            <div class="menu-icon" onclick="openNav()">‚ò∞</div>
            <div class="logo" onclick="location.reload()">g1 <span>Brookasil</span></div>
        </div>
        <div class="user-section" onclick="irPara('conta')">
            üë§ <span id="user-name-display">Criar Conta</span>
        </div>
    </header>

    <div class="weather-strip">
        <span id="clima-display">üå§Ô∏è Brookasil: 24¬∞C (Carregando...)</span>
        <span class="live">‚óè AO VIVO</span>
    </div>

    <div class="sub-header">
        <a onclick="irPara('noticias')">Not√≠cias</a>
        <a onclick="irPara('classificados')">Classificados</a>
        <a onclick="irPara('candidatura')">CDE</a>
    </div>

    <nav id="mySidebar">
        <span class="closebtn" onclick="closeNav()">&times;</span>
        <a onclick="location.reload()">üè† Capa do G1</a>
        <a onclick="irPara('classificados')">üíº Classificados / Empregos</a>
        <a onclick="irPara('candidatura')">üìù Candidaturas</a>
        <a onclick="irPara('filiacao')">ü§ù Filia√ß√£o</a>
        <hr>
        <a onclick="abrirLogin('jornalista')" style="color:var(--g1-red)">‚úçÔ∏è Painel Jornalista</a>
        <a onclick="abrirLogin('dono')">üëë Administra√ß√£o</a>
        <a id="btn-logout" onclick="logout()" style="display:none">üö™ Sair</a>
    </nav>

    <div class="container">
        <div id="section-noticias" class="section active">
            <div id="news-feed" class="news-grid"></div>
        </div>

        <div id="section-classificados" class="section">
            <h2 style="color:var(--xmas-green)">üíº Classificados Brookasil</h2>
            <div style="background:white; padding:20px; border-radius:10px; margin-bottom:30px;">
                <h4>Anunciar Vaga ou Venda</h4>
                <textarea id="ad-text" placeholder="Ex: Contrata-se mec√¢nico para a oficina norte. Falar com Jo√£o."></textarea>
                <button class="btn-post" style="background:var(--xmas-green)" onclick="postarAnuncio()">Publicar An√∫ncio</button>
            </div>
            <div id="ads-feed" class="ads-grid"></div>
        </div>

        <div id="section-conta" class="section">
            <div style="max-width:400px; margin: 0 auto; background:white; padding:30px; border-radius:12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                <h2 style="text-align:center; color:var(--g1-red)">Minha Conta G1</h2>
                <label>Nome do Personagem (RP):</label>
                <input type="text" id="user-name-input" placeholder="Ex: Roberto_Mendes">
                <button class="btn-post" onclick="salvarConta()">SALVAR PERFIL</button>
                <p style="font-size:12px; color:#999; margin-top:15px; text-align:center;">Seu perfil ficar√° salvo neste navegador.</p>
            </div>
        </div>

        <div id="section-admin" class="section">
            <div style="background:white; padding:20px; border-radius:10px;">
                <h3>‚öôÔ∏è Painel de Controle</h3>
                <label>Alterar Clima:</label>
                <input type="text" id="clima-input" placeholder="Ex: ‚õàÔ∏è Tempestade: 19¬∞C">
                <button class="btn-post" style="background:#444" onclick="mudarClima()">Atualizar Clima</button>
                <hr>
                <h3>‚úçÔ∏è Postar Not√≠cia</h3>
                <input type="text" id="post-tit" placeholder="T√≠tulo">
                <input type="text" id="post-img" placeholder="URL da Imagem">
                <textarea id="post-desc" rows="5" placeholder="Texto da not√≠cia"></textarea>
                <button class="btn-post" onclick="postarNoticia()">Publicar no G1</button>
            </div>
        </div>
    </div>

    <div id="news-modal">
        <div style="max-width:700px; margin:0 auto; padding:40px 20px;">
            <button onclick="fecharNoticia()" style="background:var(--g1-red); color:white; border:none; padding:10px 20px; border-radius:50px; cursor:pointer; font-weight:bold;">‚Üê VOLTAR</button>
            <div id="modal-content"></div>
            
            <div class="comments-section">
                <h4>Coment√°rios</h4>
                <div id="comments-list"></div>
                <div style="margin-top:20px;">
                    <input type="text" id="comment-input" placeholder="O que voc√™ acha disso?">
                    <button class="btn-post" id="btn-comentar">COMENTAR</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        const firebaseConfig = { databaseURL: "https://g1-brookasil-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // CONTA LOCALSTORAGE
        function salvarConta() {
            const nome = document.getElementById('user-name-input').value;
            if(nome) {
                localStorage.setItem('g1_user_name', nome);
                notify("Perfil Salvo!");
                location.reload();
            }
        }

        function carregarUser() {
            const nome = localStorage.getItem('g1_user_name');
            if(nome) {
                document.getElementById('user-name-display').innerText = nome;
                document.getElementById('user-name-input').value = nome;
            }
        }

        // CLIMA
        function mudarClima() {
            const val = document.getElementById('clima-input').value;
            db.ref('config/clima').set(val).then(() => notify("Clima atualizado!"));
        }
        db.ref('config/clima').on('value', snap => {
            if(snap.val()) document.getElementById('clima-display').innerText = snap.val();
        });

        // CLASSIFICADOS
        function postarAnuncio() {
            const user = localStorage.getItem('g1_user_name');
            const txt = document.getElementById('ad-text').value;
            if(!user) return alert("Crie uma conta primeiro!");
            if(txt) db.ref('classificados').push({ autor: user, texto: txt }).then(() => {
                document.getElementById('ad-text').value = "";
                notify("An√∫ncio publicado!");
            });
        }

        db.ref('classificados').on('value', snap => {
            const feed = document.getElementById('ads-feed');
            feed.innerHTML = "";
            snap.forEach(c => {
                const d = c.val();
                feed.innerHTML += `<div class="ad-card"><b>${d.autor}:</b><p>${d.texto}</p></div>`;
            });
        });

        // NOT√çCIAS
        function postarNoticia() {
            const t = document.getElementById('post-tit').value, i = document.getElementById('post-img').value, d = document.getElementById('post-desc').value;
            if(t && d) db.ref('noticias').push({ titulo: t, imagem: i, descricao: d, timestamp: Date.now() }).then(() => notify("Not√≠cia no ar!"));
        }

        function carregarNoticias() {
            db.ref('noticias').on('value', snap => {
                const feed = document.getElementById('news-feed');
                feed.innerHTML = "";
                snap.forEach(c => {
                    const p = c.val();
                    feed.innerHTML += `
                        <div class="card" onclick="abrirNoticia('${c.key}')">
                            ${p.imagem ? `<img src="${p.imagem}" class="card-img">` : ''}
                            <div class="card-content">
                                <h2 class="titulo">${p.titulo}</h2>
                            </div>
                        </div>`;
                });
            });
        }

        let noticiaIDAtiva = "";
        function abrirNoticia(id) {
            noticiaIDAtiva = id;
            db.ref('noticias/'+id).once('value', snap => {
                const p = snap.val();
                document.getElementById('modal-content').innerHTML = `
                    <h1 style="font-size:35px; margin:20px 0;">${p.titulo}</h1>
                    ${p.imagem ? `<img src="${p.imagem}" style="width:100%; border-radius:8px;">` : ''}
                    <p style="font-size:18px; line-height:1.7; color:#333; margin-top:20px;">${p.descricao.replace(/\n/g, '<br>')}</p>
                `;
                document.getElementById('news-modal').style.display = "block";
                carregarComentarios(id);
            });
        }

        function carregarComentarios(id) {
            db.ref('comments/'+id).on('value', snap => {
                const list = document.getElementById('comments-list');
                list.innerHTML = "";
                snap.forEach(c => {
                    const d = c.val();
                    list.innerHTML += `<div class="comment-item"><b>${d.autor}</b>: ${d.texto}</div>`;
                });
            });
        }

        document.getElementById('btn-comentar').onclick = () => {
            const user = localStorage.getItem('g1_user_name');
            const txt = document.getElementById('comment-input').value;
            if(!user) return alert("Identifique-se na aba 'Criar Conta'!");
            if(txt) db.ref('comments/'+noticiaIDAtiva).push({ autor: user, texto: txt }).then(() => {
                document.getElementById('comment-input').value = "";
            });
        };

        // UTILIT√ÅRIOS
        function irPara(aba) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('section-' + aba).classList.add('active');
            closeNav(); window.scrollTo(0,0);
        }
        function openNav() { document.getElementById("mySidebar").style.width = "320px"; }
        function closeNav() { document.getElementById("mySidebar").style.width = "0"; }
        function fecharNoticia() { document.getElementById('news-modal').style.display = "none"; }
        function notify(m) { const t = document.getElementById('toast'); t.innerText=m; t.style.display='block'; setTimeout(()=>t.style.display='none',3000); }

        window.onload = () => { carregarUser(); carregarNoticias(); initSnow(); };

        function initSnow() {
            const canvas = document.getElementById('snow');
            const ctx = canvas.getContext('2d');
            let width = canvas.width = window.innerWidth;
            let height = canvas.height = window.innerHeight;
            const flakes = [];
            for (let i = 0; i < 70; i++) flakes.push({ x: Math.random() * width, y: Math.random() * height, r: Math.random() * 3 + 1 });
            function draw() {
                ctx.clearRect(0, 0, width, height);
                ctx.fillStyle = 'rgba(255,255,255,0.7)';
                ctx.beginPath();
                flakes.forEach(f => {
                    ctx.moveTo(f.x, f.y);
                    ctx.arc(f.x, f.y, f.r, 0, Math.PI * 2, true);
                    f.y += 1;
                    if (f.y > height) f.y = -5;
                });
                ctx.fill();
                requestAnimationFrame(draw);
            }
            draw();
        }
    </script>
</body>
</html>
