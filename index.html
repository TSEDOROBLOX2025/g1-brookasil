<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>g1 - Brookasil Oficial</title>
    <style>
        :root { --g1-red: #C4170C; --g1-bg: #f6f6f6; --xmas-green: #0a5c2f; --text-main: #333; }
        body { font-family: 'Open Sans', sans-serif; margin: 0; background: var(--g1-bg); color: var(--text-main); }

        header { background: var(--g1-red); color: white; padding: 0 20px; display: flex; align-items: center; position: sticky; top: 0; z-index: 1000; height: 65px; justify-content: space-between; }
        .logo { font-weight: 900; font-size: 32px; letter-spacing: -2px; cursor: pointer; color: white; text-decoration: none; }
        
        .user-badge { display: flex; align-items: center; gap: 10px; background: rgba(0,0,0,0.2); padding: 5px 15px; border-radius: 25px; cursor: pointer; }
        .avatar-mini { width: 30px; height: 30px; border-radius: 50%; object-fit: cover; background: #eee; }

        .weather-bar { background: white; border-bottom: 1px solid #ddd; padding: 10px; text-align: center; font-size: 13px; font-weight: bold; }

        /* MENU DE TEMAS */
        .sub-nav { background: white; border-bottom: 1px solid #ddd; display: flex; justify-content: center; overflow-x: auto; position: sticky; top: 65px; z-index: 999; }
        .sub-nav a { padding: 15px; font-size: 12px; font-weight: 800; color: var(--g1-red); text-transform: uppercase; text-decoration: none; cursor: pointer; }

        .container { max-width: 1000px; margin: 20px auto; padding: 0 20px; }
        .section { display: none; }
        .section.active { display: block; }

        /* CARDS */
        .news-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .card { background: white; border-radius: 8px; overflow: hidden; border-bottom: 1px solid #ddd; cursor: pointer; }
        .card-img { width: 100%; height: 180px; object-fit: cover; }
        .card-body { padding: 15px; }
        .tag { color: var(--g1-red); font-size: 11px; font-weight: bold; text-transform: uppercase; }

        /* PERFIL */
        .profile-header { text-align: center; padding: 30px; background: white; border-radius: 12px; margin-bottom: 20px; }
        .avatar-main { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 4px solid var(--g1-red); margin-bottom: 15px; }

        /* BOT√ïES E INPUTS */
        .btn { background: var(--g1-red); color: white; border: none; padding: 12px 20px; border-radius: 5px; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; }
        input, textarea, select { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }

        /* MODAL */
        #news-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 2000; overflow-y: auto; padding: 40px 0; }
        .modal-inner { max-width: 700px; margin: 0 auto; padding: 20px; }
        .actions { display: flex; gap: 20px; margin: 20px 0; border-top: 1px solid #eee; padding-top: 15px; }

        #toast { display: none; position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #333; color: white; padding: 12px 25px; border-radius: 30px; z-index: 3000; }
    </style>
</head>
<body>

    <div id="toast">Sucesso!</div>

    <header>
        <div style="display:flex; align-items:center;">
            <span style="font-size:24px; margin-right:15px; cursor:pointer;" onclick="abrirMenu()">‚ò∞</span>
            <a class="logo" onclick="location.reload()">g1</a>
        </div>
        <div class="user-badge" onclick="irPara('conta')">
            <img id="header-avatar" class="avatar-mini" src="">
            <span id="header-nome">Entrar</span>
        </div>
    </header>

    <div class="weather-bar" id="clima-bar">üå§Ô∏è Brookasil: 25¬∞C</div>

    <div class="sub-nav">
        <a onclick="filtrar('Tudo')">Tudo</a>
        <a onclick="filtrar('Pol√≠tica')">Pol√≠tica</a>
        <a onclick="filtrar('Policial')">Policial</a>
        <a onclick="filtrar('Cidades')">Cidades</a>
        <a onclick="filtrar('Sa√∫de')">Sa√∫de</a>
    </div>

    <div class="container">
        <div id="sec-noticias" class="section active">
            <div id="feed" class="news-grid"></div>
        </div>

        <div id="sec-conta" class="section">
            <div class="profile-header">
                <img id="p-img" class="avatar-main" src="https://via.placeholder.com/150">
                <h2 id="p-nome">Seu Nome</h2>
                <p id="p-bio">Sua biografia aparecer√° aqui.</p>
                <div style="color: #666; font-size: 14px;">Seguidores: <b id="p-subs">0</b></div>
                <hr>
                <h4>Editar Perfil</h4>
                <input type="text" id="edit-nome" placeholder="Nome no RP">
                <textarea id="edit-bio" placeholder="Biografia"></textarea>
                <p>Alterar Foto (Galeria):</p>
                <input type="file" id="file-avatar" accept="image/*" onchange="previewImage(this, 'p-img')">
                <button class="btn" onclick="salvarPerfil()">Salvar Perfil</button>
            </div>
        </div>

        <div id="sec-admin" class="section">
            <div style="background:white; padding:25px; border-radius:10px;">
                <div id="admin-login">
                    <h2>Acesso Restrito</h2>
                    <input type="password" id="pass" placeholder="Digite sua senha">
                    <button class="btn" onclick="logarAdmin()">Entrar</button>
                </div>

                <div id="admin-panel" style="display:none">
                    <h2 id="panel-title">Painel</h2>
                    <div id="dono-only" style="display:none">
                        <label>Alterar Clima:</label>
                        <input type="text" id="clima-in" placeholder="Ex: ‚õàÔ∏è Chuva: 20¬∞C">
                        <button class="btn" style="background:#444" onclick="db.ref('clima').set(document.getElementById('clima-in').value)">Mudar Clima</button>
                        <hr>
                    </div>
                    <h3>‚úçÔ∏è Nova Not√≠cia</h3>
                    <input type="text" id="tit" placeholder="T√≠tulo">
                    <select id="tema-sel">
                        <option>Pol√≠tica</option><option>Policial</option><option>Cidades</option><option>Sa√∫de</option>
                    </select>
                    <textarea id="texto" rows="6" placeholder="Texto da not√≠cia"></textarea>
                    <p>Foto da Not√≠cia (Galeria):</p>
                    <input type="file" id="file-noticia" accept="image/*" onchange="previewImage(this, 'img-prev')">
                    <img id="img-prev" style="width:100px; display:none; margin-bottom:10px;">
                    <button class="btn" onclick="postarNoticia()">Publicar no G1</button>
                </div>
            </div>
        </div>
    </div>

    <div id="news-modal">
        <div class="modal-inner">
            <button class="btn" style="width:auto" onclick="fecharModal()">‚Üê Voltar</button>
            <div id="m-content"></div>
            <div class="actions">
                <span onclick="acao('like')" style="cursor:pointer">‚ù§Ô∏è Curtir</span>
                <span onclick="acao('repub')" style="cursor:pointer">üîÑ Republicar</span>
                <span onclick="acao('seguir')" style="cursor:pointer">üë§ Seguir Autor</span>
            </div>
            <hr>
            <h4>Coment√°rios</h4>
            <div id="comm-list"></div>
            <div style="display:flex; gap:10px; margin-top:10px;">
                <input type="text" id="c-in" placeholder="Escreva...">
                <button class="btn" style="width:100px; margin:0" onclick="comentar()">Enviar</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        const firebaseConfig = { databaseURL: "https://g1-brookasil-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let base64Image = "";
        let noticiaAtiva = "";

        // FUN√á√ÉO PARA PEGAR IMAGEM DA GALERIA
        function previewImage(input, targetID) {
            const file = input.files[0];
            const reader = new FileReader();
            reader.onloadend = function() {
                base64Image = reader.result;
                document.getElementById(targetID).src = reader.result;
                document.getElementById(targetID).style.display = "block";
            }
            if (file) reader.readAsDataURL(file);
        }

        // PERFIL
        function salvarPerfil() {
            const user = {
                nome: document.getElementById('edit-nome').value,
                bio: document.getElementById('edit-bio').value,
                foto: base64Image || document.getElementById('p-img').src
            };
            localStorage.setItem('g1_user', JSON.stringify(user));
            showToast("Perfil Salvo!");
            location.reload();
        }

        function carregarPerfil() {
            const u = JSON.parse(localStorage.getItem('g1_user'));
            if(u) {
                document.getElementById('header-nome').innerText = u.nome;
                document.getElementById('header-avatar').src = u.foto;
                document.getElementById('p-nome').innerText = u.nome;
                document.getElementById('p-bio').innerText = u.bio;
                document.getElementById('p-img').src = u.foto;
                document.getElementById('edit-nome').value = u.nome;
                document.getElementById('edit-bio').value = u.bio;
            }
        }

        // ADMIN
        function logarAdmin() {
            const p = document.getElementById('pass').value;
            if(p === "Brookasil1234") {
                document.getElementById('admin-login').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'block';
                document.getElementById('dono-only').style.display = 'block';
                document.getElementById('panel-title').innerText = "Painel do Dono";
            } else if(p === "G1_Brookasil") {
                document.getElementById('admin-login').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'block';
                document.getElementById('panel-title').innerText = "Painel Jornalista";
            } else { alert("Senha incorreta!"); }
        }

        function postarNoticia() {
            const t = document.getElementById('tit').value;
            const tx = document.getElementById('texto').value;
            const tema = document.getElementById('tema-sel').value;
            if(t && tx) {
                db.ref('posts').push({
                    titulo: t, texto: tx, tema: tema, foto: base64Image, autor: document.getElementById('header-nome').innerText, data: Date.now()
                }).then(() => { showToast("Not√≠cia publicada!"); irPara('noticias'); });
            }
        }

        // FEED E FILTROS
        function filtrar(tema) {
            db.ref('posts').once('value', s => {
                const feed = document.getElementById('feed'); feed.innerHTML = "";
                s.forEach(item => {
                    const p = item.val();
                    if(tema === 'Tudo' || p.tema === tema) {
                        feed.innerHTML += `
                            <div class="card" onclick="abrirNoticia('${item.key}')">
                                ${p.foto ? `<img src="${p.foto}" class="card-img">` : ''}
                                <div class="card-body">
                                    <span class="tag">${p.tema}</span>
                                    <h2 style="font-size:18px; margin:10px 0;">${p.titulo}</h2>
                                    <small>Por ${p.autor}</small>
                                </div>
                            </div>`;
                    }
                });
            });
            irPara('noticias');
        }

        function abrirNoticia(id) {
            noticiaAtiva = id;
            db.ref('posts/'+id).once('value', s => {
                const p = s.val();
                document.getElementById('m-content').innerHTML = `
                    <span class="tag">${p.tema}</span>
                    <h1 style="margin:10px 0;">${p.titulo}</h1>
                    <p style="color:#666">Publicado por <b>${p.autor}</b></p>
                    ${p.foto ? `<img src="${p.foto}" style="width:100%; border-radius:8px;">` : ''}
                    <p style="font-size:18px; line-height:1.6;">${p.texto.replace(/\n/g, '<br>')}</p>
                `;
                document.getElementById('news-modal').style.display = 'block';
                carregarComentarios(id);
            });
        }

        function comentar() {
            const u = JSON.parse(localStorage.getItem('g1_user'));
            const msg = document.getElementById('c-in').value;
            if(!u) return alert("Crie um perfil primeiro!");
            if(msg) db.ref('comentarios/'+noticiaAtiva).push({ nome: u.nome, foto: u.foto, msg: msg });
        }

        function carregarComentarios(id) {
            db.ref('comentarios/'+id).on('value', s => {
                const list = document.getElementById('comm-list'); list.innerHTML = "";
                s.forEach(c => {
                    list.innerHTML += `<div style="margin-bottom:10px; font-size:14px;">
                        <img src="${c.val().foto}" style="width:20px; height:20px; border-radius:50%; vertical-align:middle;">
                        <b>${c.val().nome}:</b> ${c.val().msg}</div>`;
                });
            });
        }

        function acao(tipo) {
            showToast("Voc√™ realizou: " + tipo + "!");
        }

        function irPara(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById('sec-' + id).classList.add('active');
        }

        function abrirMenu() { irPara('admin'); }
        function fecharModal() { document.getElementById('news-modal').style.display = 'none'; }
        function showToast(m) { const t = document.getElementById('toast'); t.innerText=m; t.style.display='block'; setTimeout(()=>t.style.display='none',2000); }

        window.onload = () => { carregarPerfil(); filtrar('Tudo'); };
        db.ref('clima').on('value', s => { if(s.val()) document.getElementById('clima-bar').innerText = s.val(); });
    </script>
</body>
</html>
